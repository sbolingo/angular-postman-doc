var postman=angular.module("angularPostmanDoc",[]);postman.factory("Postman",["$q","$http","$sce",function(a,b,c){function d(){p=void 0,q="",r=[],s=[]}function e(c){d();var e=function(a,d){b.get(c).then(function(b){o=c,p=angular.copy(b.data),a(b)},function(a){d(a)})};return a(e,10)}function f(){return o}function g(a){d(),p=angular.copy(a)}function h(){return p}function i(){return c.trustAsHtml(q)}function j(a,b){var c=null;return a.forEach(function(a){a.id==b&&(c=a)}),c}function k(a){if(!angular.isString(a)||""==a.trim())return"";var b=a.charAt(0).toLowerCase();return b+a.substr(1).replace(/[A-Z ]/g,function(a){return""==a.trim()?"-":a.toLowerCase()})}function l(a,b){var d=angular.fromJson(p),e=d.folders,f=d.requests,g=function(a){return a.replace(/[\{\}\[\]\,\"\'\:]/g,function(a){return"<span class='p'>"+a+"</span>"}).replace(/true|false/gi,function(a){return"<span class='k'>"+a+"</span>"}).replace(/([^a-z])([0-9])(?=[^a-z])|null/gi,function(a){return"<span class='mi'>"+a+"</span>"})},h=function(c,d){var e="<table ";if(angular.isString(d)&&""!=d.trim()&&(e+='id="'+k(d)+"-m-"+k(c.name)+'" '),e+='class="novice novice-postman table-request table table-bordered"><tbody>',e+='<tr><td class="novice novice-postman name" colspan="2">',a&&(e+=d+": "),e+=c.name+"</td></tr>",c.description)if(b){var f=new showdown.Converter;f.setOption("tables",!0),e+='<tr><td class="table-responsive novice novice-postman description" colspan="2">'+f.makeHtml(c.description)+"</td></tr>"}else e+='<tr><td class="novice novice-postman description" colspan="2">'+c.description+"</td></tr>";if(e+='<tr><td>Headers:</td><td class="novice novice-postman headers">'+c.headers+"</td></tr>",e+='<tr><td>Method:</td><td class="novice novice-postman method"><span class="method '+c.method.toLowerCase()+'">'+c.method+"</span></td></tr>",e+='<tr><td>URL:</td><td class="novice novice-postman url">'+c.url+"</td></tr>","params"===c.dataMode&&c.data&&c.data instanceof Array&&c.data.length>0){e+="<tr><td>Params:</td><td>";var h='<table class="novice novice-postman params">';c.data.forEach(function(a){h+="<tr><td>Key:</td><td>"+a.key+"</td></tr>",h+="<tr><td>Value:</td><td>"+a.type+"</td></tr>",h+="<tr><td>Type:</td><td>"+a.value+"</td></tr>"}),h+="</table>",e+=h,e+="</td></tr>"}else{var i=c.data;if(c.headers&&c.headers.toLowerCase().indexOf("content-type: application/json")!=-1){try{i=angular.isString(c.rawModeData)&&""!=c.rawModeData.trim()?c.rawModeData:i,i=angular.isArray(i)&&i.length>0||angular.isString(i)&&""!=i.trim()?'<pre class="novice novice-postman raw">'+g(angular.toJson(angular.fromJson(i),2))+"</pre>":"none"}catch(a){console.error("Unable to prettify JSON: "+a)}e+="<tr><td>Data:</td><td>"+i+"</td></tr>"}}return e+="</tbody></table>"};return q='<div class="novice novice-postman">',q+='<h1 class="title">'+d.name+"</h1>",e&&e.length>0?e.forEach(function(a){q+='<h2 id="'+k(a.name)+'" class="novice novice-postman folder">'+a.name+"</h2>";var b=a.name;a.order.forEach(function(a){var c=j(f,a);c&&(q+=h(c,b))})}):f.forEach(function(a){q+=h(a)}),q+="</div>",c.trustAsHtml(q)}function m(){if(r.length>0)return r;var a=angular.fromJson(p),b=a.folders;return n(),b&&b.length>0&&(b.forEach(function(a){a.order.forEach(function(b){var c=j(s,b);c&&(angular.isArray(a.requests)||(a.requests=[]),a.requests.push(c))})}),r=b),r}function n(){if(s.length>0)return s;var a=angular.fromJson(p);return s=a.requests}var o,p,q="",r=[],s=[];return{getJsonUrl:f,setCollection:g,getCollection:h,getHTMLDoc:i,getFolders:m,getRequests:n,getRequestWithId:j,toUnderscore:k,fromUrl:e,buildHTMLDoc:l}}]),postman.directive("postmanCollection",["Postman","$compile","$http","$templateCache","$timeout","$anchorScroll",function(a,b,c,d,e,f){var g={url:"postmanCollection",template:"templateUrl",showdownjs:"markdownDescription",repeatFoldername:"repeatFoldername",noCache:"noCache"};return{restrict:"A",link:function(h,i,j){var k=function(){e(function(){f()},5)},l=function(a){i.append(a),b(i.contents())(h),k()},m=function(a){h.htmlDoc=a,l(angular.element('<div ng-bind-html="htmlDoc"></div>'))},n=function(){l(d.get(j[g.template]))};if(j[g.url]==a.getJsonUrl()&&angular.isUndefined(j[g.template])&&""!=a.getHTMLDoc())return void m(a.getHTMLDoc());var o=!1;angular.isString(j[g.showdownjs])&&("true"!==j[g.showdownjs]&&""!==j[g.showdownjs]||(o=!0));var p=!1;angular.isString(j[g.repeatFoldername])&&("true"!==j[g.repeatFoldername]&&""!==j[g.repeatFoldername]||(p=!0));var q=!1;angular.isString(j[g.noCache])&&("true"!==j[g.noCache]&&""!==j[g.noCache]||(q=!0)),a.fromUrl(j[g.url]).then(function(b){angular.isUndefined(j[g.template])?m(a.buildHTMLDoc(p,o)):(h.collection=a.getCollection(),h.folders=a.getFolders(),h.requests=a.getRequests(),q?angular.isUndefined(d.get(j[g.template]))?c.get(j[g.template]).then(function(a){d.put(j[g.template],a.data),n()}):n():c.get(j[g.template]).then(function(a){l(a.data)}))})}}}]),postman.directive("postmanCollectionFolders",["Postman","$compile","$http","$q","$templateCache","$timeout","$anchorScroll","$sce","$location",function(a,b,c,d,e,f,g,h,i){var j={url:"postmanCollectionFolders",href:"ref",noCache:"noCache"},k=angular.copy(a);return{restrict:"A",link:function(a,e,f){var g,h=function(c){e.append(c),a.waitTillItsDone=!1,b(e.contents())(a),a.waitTillItsDone=!0},i=function(a,b){c.get(f[j.url]).then(function(b){g=angular.copy(b.data),a(b)},function(a){b(a)})},l=[],m=function(){if(l.length>0)return l;var a=angular.fromJson(g);return l=a.requests};d(i,10).then(function(){var b=angular.fromJson(g),c=b.folders;if(m(),c&&c.length>0){a.showMe={},c.forEach(function(b){a.showMe[b.name]=!1,b.order.forEach(function(a){b.uname=k.toUnderscore(b.name);var c=k.getRequestWithId(l,a);c&&(angular.isArray(b.requests)||(b.requests=[]),c.uname=b.uname+"-m-"+k.toUnderscore(c.name),b.requests.push(c))})}),a.folders=c,a.toggle=function(b){a.showMe[b]=!a.showMe[b]},a.getMethodPetName=function(a){var b=a;if(angular.isString(a))switch(a){case"DELETE":b="DEL";break;case"delete":b="del"}return b};var d='<div class="postman-collection-folders">';d+='<ul class="postman-folders" style="list-style-type: none; width: 100%;">',d+='<li class="postman-folder" ng-repeat="folder in folders" data-text="folder.name">',d+='<div ng-class="{\'active\': showMe[folder.name]}" data-ng-click="toggle(folder.name)" title="{{folder.name}}" ',d+='style="cursor: pointer; width: 100%; display: block; float: none;">',d+="<i ng-class=\"showMe[folder.name] ? 'icon-folder-open' : 'icon-folder'\"></i> <span class=\"postman-folder-name\">{{folder.name}}</span>",d+="</div>",d+='<ul class="postman-requests" data-ng-show="showMe[folder.name]" style="list-style-type: none; width: 100%;">',d+='<li class="postman-request" ng-repeat="r in folder.requests">',d+='<div ng-class="r.method.toLowerCase()" class="method" style="display: block; float: none;"><span>{{getMethodPetName(r.method)}}</span></div>',d+='<div class="postman-request-name" style="display: block; float: none;">';var e=angular.isUndefined(f[j.href])?"":f[j.href];d+='<a data-ng-href="'+e+'#{{r.uname}}">{{r.name}}</a>',d+="</div>",d+="</li>",d+="</ul>",d+="</li></ul></div>",h(d)}})}}}]);